---
phase: 02.2-fix-const-correctness-in-dependent-projects
plan: 02b
type: execute
wave: 1
depends_on: []
files_modified:
  - EIDConfigurationWizard/EIDConfigurationWizardPage04.cpp
  - EIDConfigurationWizard/EIDConfigurationWizardPage05.cpp
autonomous: true
must_haves:
  truths:
    - "EIDConfigurationWizardPage04.cpp and Page05.cpp compile without C2440 const-correctness errors"
    - "String literal to PTSTR/LPWSTR conversions use static buffer pattern"
    - "Full EIDConfigurationWizard project builds successfully"
  artifacts:
    - path: "EIDConfigurationWizard/EIDConfigurationWizardPage04.cpp"
      provides: "Wizard page 04 UI with const-correct list view initialization"
    - path: "EIDConfigurationWizard/EIDConfigurationWizardPage05.cpp"
      provides: "Wizard page 05 UI with const-correct password handling"
  key_links:
    - from: "EIDConfigurationWizard/EIDConfigurationWizardPage04.cpp"
      to: "ListView APIs"
      via: "LVCOLUMN.pszText"
    - from: "EIDConfigurationWizard/EIDConfigurationWizardPage05.cpp"
      to: "Tooltip API"
      via: "TOOLINFO.lpszText"
---

<objective>
Fix const-correctness errors in EIDConfigurationWizardPage04.cpp and Page05.cpp to enable C++23 compilation.

Purpose: C++23 with /Zc:strictStrings flag rejects implicit conversions from string literals (const wchar_t[]) to non-const pointers (PTSTR/LPWSTR). These wizard page files have 2 such errors.

Output: Both wizard page files compile cleanly with C++23 flag.
</objective>

<execution_context>
@C:/Users/user/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/user/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Fix Pattern from Phase 2 (02-01a, 02-01b)
- Pattern 1: Change function parameter to const when function only reads string (preferred)
- Pattern 2: Use static arrays for Windows API compatibility when non-const required

# Known Errors in Wizard Page Files
From build output analysis:
1. EIDConfigurationWizardPage04.cpp line 25: PTSTR from string literal (TEXT("Comment"))
2. EIDConfigurationWizardPage05.cpp line 75: LPWSTR from string literal (L" " in TOOLINFO)

@.planning/phases/02-error-handling/02-01a-SUMMARY.md
@.planning/phases/02-error-handling/02-01b-SUMMARY.md
@.planning/phases/02.2-fix-const-correctness-in-dependent-projects/02.2-02a-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Fix const-correctness in EIDConfigurationWizardPage04.cpp line 25</name>
  <files>EIDConfigurationWizard/EIDConfigurationWizardPage04.cpp</files>
  <action>
    Line 25 initializes a PTSTR array with a string literal:
    ```cpp
    PTSTR Columns[] = {TEXT("Comment")};
    ```

    PTSTR is wchar_t* (non-const) in Unicode builds, but TEXT("Comment") produces const wchar_t[].

    Fix per Phase 2-01b pattern: Use static TCHAR array. At the top of the file (around line 22 after includes), add:
    ```cpp
    static TCHAR s_szColumnName[] = TEXT("Comment");
    ```
    Then change line 25 to:
    ```cpp
    PTSTR Columns[] = { s_szColumnName };
    ```

    This provides a writable non-const array for PTSTR initialization.
  </action>
  <verify>
    Build EIDConfigurationWizard project with Debug|x64 configuration and verify zero C2440 errors from EIDConfigurationWizardPage04.cpp line 25
  </verify>
  <done>
    EIDConfigurationWizardPage04.cpp line 25 const-correctness error resolved; static buffer used for column name
  </done>
</task>

<task type="auto">
  <name>Fix const-correctness in EIDConfigurationWizardPage05.cpp line 75</name>
  <files>EIDConfigurationWizard/EIDConfigurationWizardPage05.cpp</files>
  <action>
    Line 75 initializes a TOOLINFO structure with a string literal:
    ```cpp
    ti.lpszText = L" ";
    ```

    The lpszText member is LPTSTR (wchar_t* non-const), but L" " is const wchar_t[].

    Fix per Phase 2-01b pattern: Use static wchar_t array for space character. At the top of the file (around line 13 after includes), add:
    ```cpp
    static wchar_t s_wszSpace[] = L" ";
    ```
    Then change line 75 to:
    ```cpp
    ti.lpszText = s_wszSpace;
    ```

    This provides a writable non-const array for LPTSTR member.
  </action>
  <verify>
    Build EIDConfigurationWizard project with Debug|x64 configuration and verify zero C2440 errors from EIDConfigurationWizardPage05.cpp line 75
  </verify>
  <done>
    EIDConfigurationWizardPage05.cpp line 75 const-correctness error resolved; static buffer used for tooltip text
  </done>
</task>

<task type="auto">
  <name>Verify EIDConfigurationWizard builds successfully</name>
  <files>EIDConfigurationWizard/EIDConfigurationWizard.vcxproj</files>
  <action>
    Build the EIDConfigurationWizard project with both Debug and Release configurations to confirm all const-correctness errors are resolved (including those fixed in plan 02a).

    Run: msbuild EIDConfigurationWizard/EIDConfigurationWizard.vcxproj /p:Configuration=Debug /p:Platform=x64 /t:Rebuild
    Then: msbuild EIDConfigurationWizard/EIDConfigurationWizard.vcxproj /p:Configuration=Release /p:Platform=x64 /t:Rebuild

    Verify zero C2440 errors in build output. Any other errors should be noted but don't block this task (focus is const-correctness).
  </action>
  <verify>
    Build output shows zero C2440 errors for EIDConfigurationWizard project
  </verify>
  <done>
    EIDConfigurationWizard builds successfully with C++23 in both Debug and Release configurations
  </done>
</task>

</tasks>

<verification>
1. Both C2440 const-correctness errors in wizard page files are fixed
2. Project builds with C++23 flag without const-related errors
3. Static buffer pattern applied consistently with Phase 2 fixes
4. No regressions in existing functionality
</verification>

<success_criteria>
EIDConfigurationWizard project compiles cleanly with /std:c++23preview flag. All string literal to non-const pointer conversions use proper const-correct patterns (static arrays).
</success_criteria>

<output>
After completion, create `.planning/phases/02.2-fix-const-correctness-in-dependent-projects/02.2-02b-SUMMARY.md`
</output>
