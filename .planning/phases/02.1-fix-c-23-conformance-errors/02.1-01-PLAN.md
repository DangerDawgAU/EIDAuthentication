---
phase: 02.1-fix-c-23-conformance-errors
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - EIDCardLibrary/credentialManagement.h
  - EIDCardLibrary/CContainerHolderFactory.h
  - EIDCardLibrary/CContainerHolderFactory.cpp
autonomous: false

must_haves:
  truths:
    - "Full solution builds with C++23 flag (/std:c++23preview) without C4596 errors"
    - "Full solution builds without C7510 typename errors in template functions"
    - "Full solution builds without C3861 identifier not found errors"
    - "Zero C++23 conformance errors remain in EIDCardLibrary"
  artifacts:
    - path: "EIDCardLibrary/credentialManagement.h"
      provides: "CSecurityContext and CUsermodeContext class definitions"
      contains: "No redundant class:: qualifiers in member declarations"
    - path: "EIDCardLibrary/CContainerHolderFactory.h"
      provides: "CContainerHolderFactory template class definition"
      contains: "No redundant class:: qualifiers in member declarations"
    - path: "EIDCardLibrary/CContainerHolderFactory.cpp"
      provides: "CContainerHolderFactory template implementation"
      contains: "#include \"GPO.h\" for GPOPolicy enum"
      contains: "typename keyword for dependent types std::list<T*>::iterator"
  key_links:
    - from: "EIDCardLibrary/CContainerHolderFactory.cpp"
      to: "GPO.h"
      via: "#include directive"
      pattern: "#include\\s+\"GPO\\.h\""
    - from: "credentialManagement.h"
      to: "Member declarations"
      via: "Unqualified member function names"
      pattern: "static\\s+\\w+\\*\\s+\\w+\\s*\\("
    - from: "CContainerHolderFactory.cpp"
      to: "Template dependent types"
      via: "typename keyword"
      pattern: "typename\\s+std::list<T\\*>::iterator"
---

<objective>
Fix all C++23 conformance errors (C4596, C7510, C3861) blocking the full solution build after Phase 2 const-correctness fixes were applied.

Purpose: These are mechanical conformance fixes required by stricter C++23 enforcement under /std:c++23preview and /permissive- modes. All fixes are low-risk and well-documented in RESEARCH.md.

Output: Full solution builds with zero conformance errors, enabling continuation of Phase 2 error handling work.
</objective>

<execution_context>
@C:/Users/user/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/user/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02.1-fix-c-23-conformance-errors/02.1-RESEARCH.md
@.planning/phases/02-error-handling/02-02-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix C4596 illegal qualified name errors in header files</name>
  <files>EIDCardLibrary/credentialManagement.h, EIDCardLibrary/CContainerHolderFactory.h</files>
  <action>
    Remove redundant class qualifiers from member declarations inside class definitions.

    **credentialManagement.h (2 fixes):**
    - Line 15: Change `static CSecurityContext* CSecurityContext::CreateContext(CCredential* pCredential);` to `static CSecurityContext* CreateContext(CCredential* pCredential);`
    - Line 77: Change `static CUsermodeContext* CUsermodeContext::GetContextFromHandle(ULONG_PTR Handle);` to `static CUsermodeContext* GetContextFromHandle(ULONG_PTR Handle);`

    **CContainerHolderFactory.h (1 fix):**
    - Line 37: Remove `CContainerHolderFactory<T>::` prefix from the CreateContainer member declaration (keep return type BOOL and all parameters, just remove the redundant qualifier)

    **Why:** C++23 /permissive- mode enforces strict conformance. Member declarations inside a class should not be qualified with the class name. This is standard C++ that was previously tolerated but now enforced.
  </action>
  <verify>Build EIDCardLibrary project - zero C4596 errors from credentialManagement.h and CContainerHolderFactory.h</verify>
  <done>C4596 errors eliminated from both header files (3 total fixes applied)</done>
</task>

<task type="auto">
  <name>Task 2: Fix C3861 missing identifier error by adding GPO.h include</name>
  <files>EIDCardLibrary/CContainerHolderFactory.cpp</files>
  <action>
    Add `#include "GPO.h"` to the includes section of CContainerHolderFactory.cpp (around lines 20-28 with other project includes).

    The file uses `GetPolicyValue(AllowSignatureOnlyKeys)` on line 103 but GPOPolicy enum is not declared. GPO.h exists at EIDCardLibrary/GPO.h and contains:
    ```cpp
    enum GPOPolicy {
        AllowSignatureOnlyKeys,
        // ... other values
    };
    DWORD GetPolicyValue(GPOPolicy Policy);
    ```

    Place the include after existing project local includes, before Windows SDK includes.
  </action>
  <verify>Build EIDCardLibrary project - C3861 error on line 103 of CContainerHolderFactory.cpp is resolved</verify>
  <done>AllowSignatureOnlyKeys identifier is found via GPO.h include</done>
</task>

<task type="auto">
  <name>Task 3: Fix C7510 typename errors in template functions</name>
  <files>EIDCardLibrary/CContainerHolderFactory.cpp</files>
  <action>
    Add `typename` prefix to dependent type declarations in template member functions.

    **Line 371:** Change `std::list<T*>::iterator l_iter = _CredentialList.begin();` to `typename std::list<T*>::iterator l_iter = _CredentialList.begin();`

    **Line 410:** Change `std::list<T*>::iterator l_iter = _CredentialList.begin();` to `typename std::list<T*>::iterator l_iter = _CredentialList.begin();`

    **Line 447:** Change `std::list<T*>::iterator it = _CredentialList.begin();` to `typename std::list<T*>::iterator it = _CredentialList.begin();`

    **Why:** In template code, `std::list<T*>::iterator` is a "dependent type" (depends on template parameter T). C++ requires `typename` to tell the compiler it's a type name, not a static member. C++23 enforces this strictly.

    **Alternative:** Consider using `auto` instead (e.g., `auto l_iter = _CredentialList.begin();`) which eliminates the typename issue entirely and is more modern C++.
  </action>
  <verify>Build EIDCardLibrary project - zero C7510 errors from CContainerHolderFactory.cpp</verify>
  <done>All three typename errors resolved (lines 371, 410, 447)</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete fix for all C++23 conformance errors (C4596, C7510, C3861) across 3 files</what-built>
  <how-to-verify>
    1. Build the full EIDAuthentication solution (Debug|x64 configuration)
    2. Verify zero C4596 errors in output
    3. Verify zero C7510 errors in output
    4. Verify zero C3861 errors in output
    5. Confirm EIDCardLibrary project compiles successfully
    6. Check that all dependent projects (CredentialProvider, AuthenticationPackage, etc.) can now compile

    Expected result: Clean build with zero conformance errors from the fixed files.
  </how-to-verify>
  <resume-signal>Type "approved" if solution builds without C4596/C7510/C3861 errors, or describe any remaining issues</resume-signal>
</task>

</tasks>

<verification>
After completing all tasks:
1. Full solution builds with C++23 flag without errors from the three fixed files
2. Zero C4596, C7510, or C3861 errors remain in EIDCardLibrary
3. All dependent projects can now compile (EIDCredentialProvider, EIDAuthenticationPackage, EIDConfigurationWizard, etc.)
</verification>

<success_criteria>
1. EIDAuthentication.sln builds successfully with Debug|x64 configuration
2. Build output shows zero C4596, C7510, C3861 errors
3. credentialManagement.h compiles without warnings about qualified names
4. CContainerHolderFactory.h compiles without warnings about qualified names
5. CContainerHolderFactory.cpp compiles with all template code using proper typename syntax
</success_criteria>

<output>
After completion, create `.planning/phases/02.1-fix-c-23-conformance-errors/02.1-01-SUMMARY.md`
</output>
