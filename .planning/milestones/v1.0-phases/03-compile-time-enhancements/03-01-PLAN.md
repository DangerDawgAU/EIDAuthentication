---
phase: 03-compile-time-enhancements
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - EIDCardLibrary/EIDCardLibrary.h
  - EIDCardLibrary/StoredCredentialManagement.h
  - EIDCardLibrary/GPO.h
  - EIDCredentialProvider/common.h
  - EIDCredentialProvider/CMessageCredential.h
  - EIDConfigurationWizard/CContainerHolder.h
autonomous: true

must_haves:
  truths:
    - "All 14 enum definitions have std::to_underlying() available via <utility> header"
    - "Any future enum-to-integer conversions can use std::to_underlying() instead of static_cast"
    - "Code compiles without errors after <utility> headers added"
    - "<utility> header is included in all files containing enum definitions"
  artifacts:
    - path: "EIDCardLibrary/EIDCardLibrary.h"
      provides: "7 enum definitions with std::to_underlying() support"
      contains: "#include <utility>"
    - path: "EIDCardLibrary/StoredCredentialManagement.h"
      provides: "EID_PRIVATE_DATA_TYPE enum with std::to_underlying() support"
      contains: "#include <utility>"
    - path: "EIDCardLibrary/GPO.h"
      provides: "GPOPolicy enum with std::to_underlying() support"
      contains: "#include <utility>"
    - path: "EIDCredentialProvider/common.h"
      provides: "2 field ID enums with std::to_underlying() support"
      contains: "#include <utility>"
    - path: "EIDCredentialProvider/CMessageCredential.h"
      provides: "CMessageCredentialStatus enum with std::to_underlying() support"
      contains: "#include <utility>"
    - path: "EIDConfigurationWizard/CContainerHolder.h"
      provides: "CheckType enum with std::to_underlying() support"
      contains: "#include <utility>"
  key_links:
    - from: "EIDCardLibrary/EIDCardLibrary.h"
      to: "std::to_underlying"
      via: "#include <utility>"
      pattern: "#include <utility>"
    - from: "Any future enum conversion"
      to: "std::to_underlying()"
      via: "Function call instead of static_cast"
      pattern: "std::to_underlying\\s*\\("
---

<objective>
Enable `std::to_underlying()` support across all 14 enum definitions in the codebase by adding `<utility>` header.

Purpose: Make std::to_underlying() available for all enum-to-integer conversions. Code analysis found no existing static_cast<int>(enum_var) patterns to replace - the codebase currently does not perform explicit enum-to-integer conversions. This task establishes the foundation for using std::to_underlying() in future code.

Output: All enum-containing headers include <utility>, enabling std::to_underlying() usage for all 14 enum types.

Note: This task achieves COMPILE-03 by ensuring std::to_underlying() is available where needed. Since no existing enum casts were found, no replacements are needed.
</objective>

<execution_context>
@C:/Users/user/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/user/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-compile-time-enhancements/03-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add <utility> header to EIDCardLibrary enum files</name>
  <files>EIDCardLibrary/EIDCardLibrary.h, EIDCardLibrary/StoredCredentialManagement.h, EIDCardLibrary/GPO.h</files>
  <action>
    For each of the 9 enum definitions in EIDCardLibrary headers:

    1. EIDCardLibrary.h (7 enums at lines 61, 85, 132, 140, 245, 254, 265):
       - EID_INTERACTIVE_LOGON_SUBMIT_TYPE
       - EID_PROFILE_BUFFER_TYPE
       - EID_CREDENTIAL_PROVIDER_READER_STATE
       - EID_CALLPACKAGE_MESSAGE
       - EID_MESSAGE_STATE
       - EID_MESSAGE_TYPE
       - EID_SSP_CALLER

    2. StoredCredentialManagement.h (1 enum at line 23):
       - EID_PRIVATE_DATA_TYPE

    3. GPO.h (1 enum at line 23):
       - GPOPolicy

    Add `#include <utility>` at the top of each file (after existing includes, before guard if needed).

    Search confirmed: No existing static_cast<int>(enum) patterns found in the codebase. The enums are used directly without explicit integer conversion. This task only ADDS the header include to enable std::to_underlying() for future use.

    Do NOT modify existing enum definitions themselves - they are compatible with std::to_underlying as-is.
  </action>
  <verify>grep -n "#include <utility>" EIDCardLibrary/EIDCardLibrary.h EIDCardLibrary/StoredCredentialManagement.h EIDCardLibrary/GPO.h</verify>
  <done>All three EIDCardLibrary headers include <utility> header for std::to_underlying support</done>
</task>

<task type="auto">
  <name>Task 2: Add <utility> header to EIDCredentialProvider enum files</name>
  <files>EIDCredentialProvider/common.h, EIDCredentialProvider/CMessageCredential.h</files>
  <action>
    For the 3 enum definitions in EIDCredentialProvider headers:

    1. common.h (2 enums at lines 35, 47):
       - SAMPLE_FIELD_ID
       - SAMPLE_MESSAGE_FIELD_ID

    2. CMessageCredential.h (1 enum at line 32):
       - CMessageCredentialStatus

    Add `#include <utility>` at the top of each file (after existing includes).

    Do NOT modify existing enum definitions - they are compatible with std::to_underlying as-is.
  </action>
  <verify>grep -n "#include <utility>" EIDCredentialProvider/common.h EIDCredentialProvider/CMessageCredential.h</verify>
  <done>All EIDCredentialProvider headers include <utility> header for std::to_underlying support</done>
</task>

<task type="auto">
  <name>Task 3: Add <utility> header to EIDConfigurationWizard enum file</name>
  <files>EIDConfigurationWizard/CContainerHolder.h</files>
  <action>
    For the 1 enum definition in EIDConfigurationWizard headers:

    1. CContainerHolder.h (1 enum at line 26):
       - CheckType

    Add `#include <utility>` at the top of the file (after existing includes).

    Do NOT modify existing enum definitions - they are compatible with std::to_underlying as-is.
  </action>
  <verify>grep -n "#include <utility>" EIDConfigurationWizard/CContainerHolder.h</verify>
  <done>EIDConfigurationWizard header includes <utility> header for std::to_underlying support</done>
</task>

<task type="auto">
  <name>Task 4: Verify no enum-to-integer casts need replacement</name>
  <files>Entire codebase</files>
  <action>
    Verify that no existing enum-to-integer conversion patterns exist that need to be replaced with std::to_underlying().

    1. Search for static_cast patterns involving enums:
       grep -rn "static_cast<int>.*EID_" EIDCardLibrary/ EIDCredentialProvider/ EIDConfigurationWizard/
       grep -rn "static_cast.*underlying_type" EIDCardLibrary/ EIDCredentialProvider/ EIDConfigurationWizard/

    2. Search for implicit enum conversions:
       grep -rn "int.*=.*EID_" EIDCardLibrary/ EIDCredentialProvider/ EIDConfigurationWizard/

    3. Expected result: No matches found (confirmed in planning - codebase does not perform explicit enum-to-integer conversions)

    4. If any patterns ARE found unexpectedly:
       - Document each location
       - Evaluate if std::to_underlying() would be appropriate replacement
       - For this plan: Note locations for potential future work

    This task confirms that COMPILE-03 is achieved by enabling std::to_underlying() availability, not by replacing existing casts (since none exist).
  </action>
  <verify>grep -rn "static_cast.*EID_\|static_cast.*GPOPolicy\|static_cast.*CheckType" . 2>/dev/null | grep -v ".planning/"</verify>
  <done>Confirmed: No existing enum-to-integer casts found. std::to_underlying() now available for all 14 enum types.</done>
</task>

</tasks>

<verification>
Overall phase verification:

1. All 6 header files now include <utility> for std::to_underlying support
2. Code analysis confirms no existing static_cast<int>(enum) patterns need replacement
3. All 14 enum types have std::to_underlying() available for future use
4. Build succeeds without errors (verified in 03-02)
5. grep confirms 6 occurrences of "#include <utility>" across the modified files
</verification>

<success_criteria>
1. <utility> header included in all 6 files containing enum definitions
2. std::to_underlying() is available for use with all 14 enum types
3. No existing enum-to-integer casts remain (confirmed via code search)
4. Foundation established for using std::to_underlying() in future code
</success_criteria>

<output>
After completion, create `.planning/phases/03-compile-time-enhancements/03-01-SUMMARY.md`
</output>
