---
phase: 01-build-system
plan: 03
type: execute
wave: 3
depends_on:
  - 01-01
  - 01-02
files_modified:
  - EIDCardLibrary/EIDCardLibrary.vcxproj
  - EIDCredentialProvider/EIDCredentialProvider.vcxproj
  - EIDAuthenticationPackage/EIDAuthenticationPackage.vcxproj
  - EIDConfigurationWizard/EIDConfigurationWizard.vcxproj
  - EIDConfigurationWizardElevated/EIDConfigurationWizardElevated.vcxproj
  - EIDLogManager/EIDLogManager.vcxproj
  - EIDPasswordChangeNotification/EIDPasswordChangeNotification.vcxproj
autonomous: false

must_haves:
  truths:
    - "All 7 projects consistently use stdcpp23preview language standard"
    - "Full solution builds with zero errors in both Debug and Release"
    - "Static CRT linkage (/MT) is preserved in all Release configurations"
    - "No new C++23-specific compiler warnings introduced"
  artifacts:
    - path: "EIDCredentialProvider.sln"
      provides: "Solution-level build verification"
      contains: "All 7 project references"
  key_links:
    - from: "All .vcxproj files"
      to: "CRT libraries"
      via: "RuntimeLibrary element"
      pattern: "<RuntimeLibrary>MultiThreaded"
    - from: "MSVC compiler"
      to: "C++23 standard library"
      via: "/std:c++23preview flag"
      pattern: "LanguageStandard.*stdcpp23preview"
---

<objective>
Verify consistent C++23 configuration across all projects and confirm no regressions in CRT linkage or warnings.

Purpose: Final verification that the C++23 upgrade is complete and correct. Ensure all 7 projects have consistent settings, static CRT is preserved (critical for LSASS components), and no new warnings were introduced by the compiler flag change.

Output: Verified solution with documented configuration status.
</objective>

<execution_context>
@C:/Users/user/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/user/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-build-system/01-build-system-RESEARCH.md
@.planning/phases/01-build-system/01-01-SUMMARY.md
@.planning/phases/01-build-system/01-02-SUMMARY.md
@.planning/codebase/STACK.md
@.planning/codebase/ARCHITECTURE.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Verify LanguageStandard consistency across all projects</name>
  <files>
    EIDCardLibrary/EIDCardLibrary.vcxproj
    EIDCredentialProvider/EIDCredentialProvider.vcxproj
    EIDAuthenticationPackage/EIDAuthenticationPackage.vcxproj
    EIDConfigurationWizard/EIDConfigurationWizard.vcxproj
    EIDConfigurationWizardElevated/EIDConfigurationWizardElevated.vcxproj
    EIDLogManager/EIDLogManager.vcxproj
    EIDPasswordChangeNotification/EIDPasswordChangeNotification.vcxproj
  </files>
  <action>
    Verify that all 7 .vcxproj files have exactly 4 LanguageStandard elements, all with value "stdcpp23preview".

    Check:
    - EIDCardLibrary.vcxproj: grep -c "LanguageStandard" should return 4
    - EIDCredentialProvider.vcxproj: grep -c "LanguageStandard" should return 4
    - EIDAuthenticationPackage.vcxproj: grep -c "LanguageStandard" should return 4
    - EIDConfigurationWizard.vcxproj: grep -c "LanguageStandard" should return 4
    - EIDConfigurationWizardElevated.vcxproj: grep -c "LanguageStandard" should return 4
    - EIDLogManager.vcxproj: grep -c "LanguageStandard" should return 4
    - EIDPasswordChangeNotification.vcxproj: grep -c "LanguageStandard" should return 4

    Total should be 28 LanguageStandard elements across all projects.

    Additionally verify all values are "stdcpp23preview" (not "stdcpp20", "stdcpplatest", etc.).
  </action>
  <verify>
    for f in EIDCardLibrary/EIDCardLibrary.vcxproj EIDCredentialProvider/EIDCredentialProvider.vcxproj EIDAuthenticationPackage/EIDAuthenticationPackage.vcxproj EIDConfigurationWizard/EIDConfigurationWizard.vcxproj EIDConfigurationWizardElevated/EIDConfigurationWizardElevated.vcxproj EIDLogManager/EIDLogManager.vcxproj EIDPasswordChangeNotification/EIDPasswordChangeNotification.vcxproj; do grep -c "LanguageStandard" "$f"; done | awk '{sum+=$1} END {print sum; exit sum==28?0:1}'
  </verify>
  <done>All 7 projects have 4 LanguageStandard elements each, all with value stdcpp23preview</done>
</task>

<task type="auto">
  <name>Task 2: Verify static CRT linkage in Release configurations</name>
  <files>
    EIDCardLibrary/EIDCardLibrary.vcxproj
    EIDCredentialProvider/EIDCredentialProvider.vcxproj
    EIDAuthenticationPackage/EIDAuthenticationPackage.vcxproj
    EIDConfigurationWizard/EIDConfigurationWizard.vcxproj
    EIDConfigurationWizardElevated/EIDConfigurationWizardElevated.vcxproj
    EIDLogManager/EIDLogManager.vcxproj
    EIDPasswordChangeNotification/EIDPasswordChangeNotification.vcxproj
  </files>
  <action>
    Verify that all Release configurations (Release|Win32 and Release|x64) use RuntimeLibrary="MultiThreaded" (static CRT, /MT).

    This is CRITICAL for LSASS components (EIDAuthenticationPackage, EIDCredentialProvider) which must use static CRT to avoid dynamic CRT loading issues in the security context.

    For each .vcxproj file:
    1. Find Release|Win32 ItemDefinitionGroup/ClCompile
    2. Verify RuntimeLibrary is "MultiThreaded" (not "MultiThreadedDLL")
    3. Find Release|x64 ItemDefinitionGroup/ClCompile
    4. Verify RuntimeLibrary is "MultiThreaded"

    Expected: All 7 projects have MultiThreaded in Release configurations.
  </action>
  <verify>
    grep -A 5 "Release|Win32" EIDCardLibrary/EIDCardLibrary.vcxproj | grep "RuntimeLibrary.*MultiThreaded" &&
    grep -A 5 "Release|x64" EIDCardLibrary/EIDCardLibrary.vcxproj | grep "RuntimeLibrary.*MultiThreaded"
  </verify>
  <done>All Release configurations use MultiThreaded (static CRT)</done>
</task>

<task type="auto">
  <name>Task 3: Build full solution in Debug configuration</name>
  <files>EIDCredentialProvider.sln</files>
  <action>
    Build the complete solution in Debug|x64 configuration to verify C++23 compilation works across all projects.

    Command:
    ```
    msbuild EIDCredentialProvider.sln /p:Configuration=Debug /p:Platform=x64 /t:Rebuild /v:normal /nologo
    ```

    Capture build output to check for:
    - Exit code 0 (success)
    - Zero errors
    - Any new C++23-specific warnings (note them)

    Expected output files:
    - x64\Debug\EIDCardLibrary.lib
    - x64\Debug\EIDCredentialProvider.dll
    - x64\Debug\EIDAuthenticationPackage.dll
    - x64\Debug\EIDConfigurationWizard.exe
    - x64\Debug\EIDConfigurationWizardElevated.exe
    - x64\Debug\EIDLogManager.exe
    - x64\Debug\EIDPasswordChangeNotification.dll
  </action>
  <verify>msbuild EIDCredentialProvider.sln /p:Configuration=Debug /p:Platform=x64 /t:Rebuild /v:minimal /nologo 2>&1 | tail -1</verify>
  <done>Debug|x64 build completes with exit code 0, zero errors</done>
</task>

<task type="auto">
  <name>Task 4: Build full solution in Release configuration</name>
  <files>EIDCredentialProvider.sln</files>
  <action>
    Build the complete solution in Release|x64 configuration to verify production build works.

    Command:
    ```
    msbuild EIDCredentialProvider.sln /p:Configuration=Release /p:Platform=x64 /t:Rebuild /v:normal /nologo
    ```

    Capture build output to check for:
    - Exit code 0 (success)
    - Zero errors
    - Any new C++23-specific warnings (note them)

    Expected output files:
    - x64\Release\EIDCardLibrary.lib
    - x64\Release\EIDCredentialProvider.dll
    - x64\Release\EIDAuthenticationPackage.dll
    - x64\Release\EIDConfigurationWizard.exe
    - x64\Release\EIDConfigurationWizardElevated.exe
    - x64\Release\EIDLogManager.exe
    - x64\Release\EIDPasswordChangeNotification.dll
  </action>
  <verify>msbuild EIDCredentialProvider.sln /p:Configuration=Release /p:Platform=x64 /t:Rebuild /v:minimal /nologo 2>&1 | tail -1</verify>
  <done>Release|x64 build completes with exit code 0, zero errors</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Full solution verification complete - all 7 projects build with C++23 in both Debug and Release configurations</what-built>
  <how-to-verify>
    Review the build outputs from Tasks 3 and 4:

    1. Confirm both Debug and Release builds completed successfully
    2. Check for any NEW compiler warnings introduced by the C++23 flag
       - Look for warnings mentioning C++23 features, deprecated behavior, etc.
       - Compare against baseline if available (build before C++23 change)
    3. Verify all expected output files exist:
       ```
       dir x64\Debug\*.dll x64\Debug\*.exe x64\Debug\*.lib
       dir x64\Release\*.dll x64\Release\*.exe x64\Release\*.lib
       ```

    Expected: Both configurations build cleanly with zero errors. Any warnings present are pre-existing or non-critical C++23 advisory warnings.

    If critical errors exist, describe them for next phase (error handling modernization may resolve some C++23-related issues).
  </how-to-verify>
  <resume-signal>Type "Verification complete" or describe any issues found</resume-signal>
</task>

</tasks>

<verification>
All 7 projects have consistent C++23 configuration (28 LanguageStandard elements total).
Static CRT linkage (/MT) preserved in all Release configurations.
Full solution builds in both Debug and Release with zero errors.
No new C++23-specific warnings that would block deployment.
</verification>

<success_criteria>
1. grep confirms 28 LanguageStandard elements across all projects
2. All Release configurations use MultiThreaded RuntimeLibrary
3. msbuild exits with code 0 for both Debug and Release builds
4. All 14 expected output files exist (7 Debug + 7 Release)
</success_criteria>

<output>
After completion, create `.planning/phases/01-build-system/01-03-SUMMARY.md`
</output>
