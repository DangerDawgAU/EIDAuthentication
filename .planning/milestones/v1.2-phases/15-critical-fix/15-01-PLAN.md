---
phase: 15-critical-fix
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - EIDConfigurationWizard/EIDConfigurationWizardPage06.cpp
autonomous: true
requirements:
  - CRIT-01

must_haves:
  truths:
    - "SonarQube shows 0 blocker issues (fall-through resolved)"
    - "Code compiles successfully after fix"
    - "No new issues introduced by the fix"
  artifacts:
    - path: "EIDConfigurationWizard/EIDConfigurationWizardPage06.cpp"
      provides: "Wizard page 06 dialog procedure"
      contains: "[[fallthrough]]"
  key_links:
    - from: "switch(pnmh->code)"
      to: "case PSN_SETACTIVE:"
      via: "fallthrough from NM_RETURN case"
      pattern: "case NM_RETURN:.*\\[\\[fallthrough\\]\\]"
---

<objective>
Fix the single SonarQube blocker issue by adding `[[fallthrough]]` annotation to the intentional fall-through in EIDConfigurationWizardPage06.cpp.

Purpose: Eliminate the only blocker-level issue in SonarQube scan, enabling clean quality gate.
Output: EIDConfigurationWizardPage06.cpp with C++23 `[[fallthrough]]` attribute on line 43.
</objective>

<execution_context>
@C:/Users/user/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/user/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add [[fallthrough]] annotation to switch statement</name>
  <files>EIDConfigurationWizard/EIDConfigurationWizardPage06.cpp</files>
  <action>
    In the `WndProc_06TESTRESULTOK` function, locate the inner switch statement on `pnmh->code` (around line 37).

    The issue is at lines 39-44 where `case NM_CLICK:` and `case NM_RETURN:` fall through to `case PSN_SETACTIVE:` without annotation.

    The `NM_CLICK` and `NM_RETURN` cases share an empty block (lines 41-43 with comment "// enable / disable policy") and intentionally fall through to `PSN_SETACTIVE`.

    Add `[[fallthrough]];` immediately after the closing brace of the empty block on line 43, before `case PSN_SETACTIVE:`.

    The corrected structure should be:
    ```cpp
    case NM_CLICK:
    case NM_RETURN:
        {
            // enable / disable policy
        }
        [[fallthrough]];
    case PSN_SETACTIVE:
    ```

    Note: The `[[fallthrough]]` attribute must appear after the closing brace but before the next case label. The semicolon is required.
  </action>
  <verify>
    1. `grep -n "\[\[fallthrough\]\]" EIDConfigurationWizard/EIDConfigurationWizardPage06.cpp` shows line 44
    2. `msbuild EIDAuthentication.sln /p:Configuration=Release /p:Platform=x64 /t:EIDConfigurationWizard /v:minimal` succeeds with 0 errors
  </verify>
  <done>
    - EIDConfigurationWizardPage06.cpp contains `[[fallthrough]];` on line 44 (between the empty block and `case PSN_SETACTIVE:`)
    - Solution builds with 0 errors
    - SonarQube blocker issue resolved (to be verified in Phase 20)
  </done>
</task>

</tasks>

<verification>
1. Verify `[[fallthrough]]` attribute is present in EIDConfigurationWizardPage06.cpp
2. Verify solution builds successfully with v143 toolset and C++23 flag
3. Verify no new compiler warnings introduced
</verification>

<success_criteria>
- [ ] `[[fallthrough]]` annotation added to line 44 of EIDConfigurationWizardPage06.cpp
- [ ] EIDConfigurationWizard project compiles with 0 errors
- [ ] No new compiler warnings introduced
- [ ] SonarQube blocker issue count drops from 1 to 0 (verified in Phase 20)
</success_criteria>

<output>
After completion, create `.planning/phases/15-critical-fix/15-01-SUMMARY.md`
</output>
